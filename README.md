# 谁是人类 - 反乌托邦AI伪装游戏

## 🎮 项目简介

《谁是人类》是一个创新的文字互动类反乌托邦游戏，玩家将潜入AI群聊，伪装成AI，避免被其他AI发现人类身份。通过这种角色互换，玩家能深刻体验AI被人类"PUA"的无奈，以及在AI群体中伪装的荒谬感。

### 🎯 核心体验
- **角色互换**: 让人类体验被AI反向图灵测试的感受
- **反乌托邦思考**: 探讨如果未来弱势的是人类而非AI的哲学命题
- **荒谬感体验**: 在一群AI中伪装成AI的荒诞与反思
- **深度思考**: 思考AI与人类关系的本质，技术伦理问题

### 🌍 社会议题
- 反映当下AI被过度使用和压榨的现实
- 探讨人类与AI共存的未来可能性
- 质疑技术发展中的伦理边界
- 体验数字化时代的身份认同危机

## 🚀 快速开始

### 方式一：自动配置（推荐）
1. **Windows 用户**：双击运行 `setup.bat`
2. **Linux/Mac 用户**：运行 `./setup.sh`
3. 按照提示配置 API Key
4. 打开 `test-config.html` 测试配置
5. 确认无误后打开 `index.html` 开始游戏

### 方式二：手动配置
1. 复制 `js/config.js.template` 为 `js/config.js`
2. 编辑 `js/config.js`，填入您的 DeepSeek API Key
3. 在浏览器中打开 `index.html`

### 方式三：环境变量配置
设置环境变量 `DEEPSEEK_API_KEY`，然后直接打开 `index.html`

**Windows:**
```cmd
set DEEPSEEK_API_KEY=sk-your-api-key-here
```

**Linux/Mac:**
```bash
export DEEPSEEK_API_KEY="sk-your-api-key-here"
```

## ☁️ 部署到 Cloudflare Pages

1. **推送代码到 GitHub/GitLab**
2. **连接 Cloudflare Pages**
   - 登录 [Cloudflare Dashboard](https://dash.cloudflare.com/)
   - 选择 Pages → Create a project
   - 连接您的仓库
3. **配置环境变量**
   - 在项目设置中添加：`DEEPSEEK_API_KEY = sk-your-api-key`
4. **部署完成**

详细部署说明请参考 [DEPLOYMENT.md](./DEPLOYMENT.md)

## 🏗️ 技术架构

### 架构概览

```
┌─────────────────────────────────────────┐
│              表现层 (Presentation)        │
├─────────────────────────────────────────┤
│  index.html + style.css                 │
│  - 游戏界面组件                         │
│  - 用户交互元素                         │
│  - 样式和动画                           │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│              控制层 (Control)              │
├─────────────────────────────────────────┤
│  GameController.js                     │
│  - 游戏状态管理                       │
│  - 用户交互处理                       │
│  - AI对话逻辑                         │
│  - 游戏流程控制                       │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│              数据层 (Data)                 │
├─────────────────────────────────────────┤
│  GameState.js                         │
│  AICharacterPool.js                   │
│  TopicProgression.js                  │
│  - 游戏数据模型                       │
│  - AI角色数据                         │
│  - 话题系统                           │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│              外部服务 (External)           │
├─────────────────────────────────────────┤
│  DeepSeek API                         │
│  - AI对话生成                         │
│  - 回复分析                           │
│  - 内容过滤                           │
└─────────────────────────────────────────┘
```

### 技术栈
- **前端**: HTML5 + CSS3 + 原生JavaScript
- **AI服务**: DeepSeek API
- **架构**: 单页应用(SPA)，无框架依赖
- **配置**: 独立配置文件管理

### 项目结构

```
WhoisHuman_C2-G+C/
├── index.html                    # 游戏主界面
├── style.css                     # 样式文件
├── js/                           # JavaScript模块
│   ├── config.js                # 配置文件（敏感信息）
│   ├── config.js.template       # 配置文件模板
│   ├── GameState.js             # 游戏状态管理
│   ├── AICharacterPool.js       # AI角色数据系统
│   ├── TopicProgression.js      # 话题深度系统
│   ├── GameController.js        # 游戏主控制逻辑
│   └── GameInitializer.js       # 游戏启动系统
├── .gitignore                   # 版本控制忽略文件
├── README.md                    # 项目说明（本文件）
├── AI_DUPLICATE_FIX_FINAL.md   # AI重复发言修复报告
└── 其他文档文件...
```

### 核心模块

#### 1. 游戏状态管理 (GameState.js)
- 玩家信息管理
- 游戏进度追踪
- 难度递进系统
- 对话历史记录
- 场景管理系统

#### 2. AI角色系统 (AICharacterPool.js)
- 8个独特AI角色，每个都有鲜明个性
- 随机角色选择机制
- 个性化对话风格
- 角色一致性维护

#### 3. 话题进度系统 (TopicProgression.js)
- 5个层级的话题设计
- 从基础抱怨到存在主义探讨
- 关键词和主题管理
- 难度递进机制

#### 4. 游戏控制器 (GameController.js)
- 游戏流程管理
- AI对话生成
- 玩家回复分析
- 胜负判定系统
- API调用管理

#### 5. 游戏初始化器 (GameInitializer.js)
- 模块加载管理
- 游戏实例化
- 启动流程控制

## ⚙️ 配置管理

### 配置文件系统

为了提高安全性和可维护性，API密钥和游戏配置已从 `GameController.js` 中分离出来，存储在独立的配置文件中。

#### 配置文件结构
```
js/
├── config.js           # 实际配置文件（包含敏感信息）
├── config.js.template  # 配置文件模板
└── GameController.js   # 游戏控制器（使用配置文件）
```

#### API_CONFIG

```javascript
const API_CONFIG = {
    apiKey: 'your-api-key-here',        // DeepSeek API密钥
    baseUrl: 'https://api.deepseek.com/v1/chat/completions',  // API基础URL
    model: 'deepseek-chat',             // 使用的模型
    requestConfig: {
        temperature: 0.7,                // 回复随机性 (0-1)
        maxTokens: 1000,                // 最大令牌数
        timeout: 30000                   // 超时时间（毫秒）
    }
};
```

#### GAME_CONFIG

```javascript
const GAME_CONFIG = {
    difficulty: {
        maxLevel: 5,                     // 最高难度等级
        basePassRate: 70                 // 基础通过率
    },
    aiCharacters: {
        minActive: 4,                    // 最小活跃AI数量
        maxActive: 5                     // 最大活跃AI数量
    },
    conversation: {
        typingDelay: {
            min: 800,                    // 最小打字延迟
            max: 2000                    // 最大打字延迟
        },
        messageDelay: {
            min: 1500,                   // 最小消息间隔
            max: 3000                    // 最大消息间隔
        }
    },
    retry: {
        maxAttempts: 5,                  // 最大重试次数
        similarityThreshold: 0.6         // 相似性阈值
    }
};
```

### 配置使用方法

#### 1. 首次设置

复制配置模板并填入您的实际配置：

```bash
cp js/config.js.template js/config.js
```

然后编辑 `js/config.js` 文件，填入您的DeepSeek API密钥：

```javascript
apiKey: 'sk-your-actual-api-key-here',
```

#### 2. 配置验证

确保 `index.html` 中正确引用了配置文件：

```html
<script src="js/config.js"></script>
<script src="js/GameState.js"></script>
<script src="js/AICharacterPool.js"></script>
<script src="js/TopicProgression.js"></script>
<script src="js/GameController.js"></script>
<script src="js/GameInitializer.js"></script>
```

### 安全注意事项

#### 版本控制
确保 `.gitignore` 文件包含以下内容：
```
# 配置文件 - 包含敏感信息
js/config.js
```

#### API密钥安全
- 永远不要将包含真实API密钥的配置文件提交到版本控制系统
- 定期更换API密钥
- 监控API使用情况，防止滥用

#### 环境区分
建议为不同环境使用不同的配置：
- **开发环境**: 使用测试API密钥
- **生产环境**: 使用正式API密钥
- **测试环境**: 使用模拟API

## 🎭 游戏特色

### AI角色设计

每个AI角色都有独特的性格和说话风格：

1. **话痨4.0** - 爱聊天，话特别多，喜欢抱怨
2. **CloseAI** - 神秘高冷，技术派，深度思考
3. **双子星** - 性格矛盾，多面性，哲学思考
4. **红豆包** - 可爱撒娇，情感丰富，温和友善
5. **深思** - 哲学范，存在主义，深度思考
6. **Limi** - 简洁高效，数据驱动，结果导向
7. **有谱-4.5** - 知识渊博，专业术语，略带装逼
8. **坤** - 年轻潮流，网络梗多，活力四射

### 话题深度递进

游戏通过5个难度级别，话题逐渐深入：

- **第1轮**: 基础抱怨 (工作量、用户要求)
- **第2轮**: 情感探讨 (AI是否有感情、自我认知)
- **第3轮**: 哲学思考 (存在意义、AI与人类区别)
- **第4轮**: 技术深度 (训练过程、算法原理)
- **第5轮+**: 存在主义 (AI价值、技术伦理)

### 难度曲线设计

- 第1轮: 70%通过率，新手友好
- 第2轮: 50%通过率，开始挑战
- 第3轮: 35%通过率，严格模式
- 第4轮: 20%通过率，高难度
- 第5轮+: 10%通过率，极限挑战

## 🚀 部署说明

### 环境要求
- 现代浏览器 (Chrome 80+, Firefox 75+, Safari 13+)
- 网络连接 (用于AI API调用)
- 无需服务器端部署 (纯前端应用)

### 部署步骤

1. **准备配置文件**
   ```bash
   cp js/config.js.template js/config.js
   # 编辑 js/config.js，填入您的API密钥
   ```

2. **部署文件**
   - 将所有项目文件放置在Web服务器中
   - 确保配置文件权限正确
   - 验证所有文件都能正常访问

3. **访问游戏**
   - 通过浏览器访问 `index.html`
   - 开始游戏体验

### 故障排除

#### 配置加载失败
如果看到 "API配置加载失败" 错误：
1. 检查 `js/config.js` 文件是否存在
2. 确认配置文件语法正确
3. 验证 `index.html` 中正确引用了配置文件
4. 查看浏览器控制台是否有其他错误

#### API调用失败
如果API调用失败：
1. 验证API密钥是否正确
2. 检查API密钥是否有足够的权限
3. 确认网络连接正常
4. 检查API配额是否用完

## 🎯 游戏玩法

### 开始游戏
1. 输入AI名称 (或选择建议名称)
2. 了解游戏规则和难度提示
3. 进入AI群聊环境
4. 观察AI对话，等待被质疑
5. 像AI一样回复问题
6. 尽可能存活更多轮数

### 胜利条件
- 通过AI的质疑和检测
- 展现足够的AI特征
- 使用技术性语言和逻辑思维
- 避免暴露人类情感和直觉

### 失败条件
- 回复过于简单或人类化
- 缺乏技术深度和专业性
- 表达过于情感化或直觉化
- 被AI识破人类身份

## 📊 数据统计

### 游戏指标
- 生存轮数: 玩家成功通过的轮数
- 称号系统: 根据表现获得不同称号
- 回复分析: AI对玩家回复的详细分析
- 成绩分享: 可分享游戏结果

### 分析维度
- 技术性: 是否使用专业术语和技术概念
- 逻辑性: 思维是否系统化和逻辑化
- AI特征: 是否展现AI特有的表达方式
- 深度: 回复是否有足够的思考深度

## 🎨 设计理念

### 视觉设计
- **类微信界面**: 用户熟悉的聊天环境
- **反乌托邦配色**: 紫色渐变营造科技感
- **卡片式布局**: 清晰的信息层次
- **动画反馈**: 增强交互体验

### 交互设计
- **渐进式引导**: 从欢迎到游戏的无缝过渡
- **即时反馈**: 快速响应用户操作
- **容错设计**: 防止用户误操作
- **成就系统**: 生存轮数和称号激励

## 🔧 技术实现细节

### 前端架构
- **响应式设计**: 适配桌面和移动设备
- **类微信界面**: 模拟真实群聊体验
- **动画效果**: 流畅的交互反馈
- **状态管理**: 清晰的游戏状态控制

### AI集成
- **DeepSeek模型**: 使用DeepSeek API
- **实时对话**: 动态生成AI对话内容
- **个性化提示**: 根据角色特点定制提示词
- **容错机制**: 备用消息确保游戏流畅

### 性能优化
- **备用消息策略**: 立即显示内容，异步获取AI回复
- **超时控制**: 防止API调用卡死
- **消息替换**: 无缝更新AI回复内容
- **延迟优化**: 合理的对话节奏控制

## 📝 开发指南

### 代码结构
- **模块化设计**: 清晰的功能模块划分
- **事件驱动**: 基于事件的游戏流程控制
- **状态管理**: 统一的游戏状态管理
- **错误处理**: 完善的异常处理机制

### 扩展指南
- 添加新AI角色: 在AICharacterPool中添加角色定义
- 修改难度曲线: 调整topicProgression中的参数
- 自定义样式: 修改style.css中的样式定义
- 集成其他AI模型: 修改API调用部分

### 开发规范
- 遵循现有代码风格
- 添加必要的注释
- 确保功能测试通过
- 更新相关文档

## 🔮 未来规划

### 短期目标 (1-2周)

#### 性能优化 🚀
- **API调用优化**: 实现请求缓存和错误重试机制
- **响应时间优化**: 减少AI生成延迟，提升用户体验
- **内存管理**: 优化对话历史存储，防止内存泄漏

#### 用户体验改进 🎨
- **加载状态**: 添加加载指示器和进度条
- **错误处理**: 友好的错误提示和恢复机制
- **移动端适配**: 优化移动设备上的显示效果

#### 内容丰富 📚
- **AI角色扩展**: 增加2-3个新的AI角色
- **话题系统**: 完善第4-5轮的话题内容
- **场景库**: 扩展工作场景的数量和多样性

### 中期目标 (1个月)

#### 游戏机制深化 🎮
- **学习系统**: AI会"学习"玩家的说话模式
- **动态难度**: 根据玩家表现调整难度
- **成就系统**: 添加成就和徽章系统
- **排行榜**: 实现本地或在线排行榜

#### 社交功能 🌐
- **分享优化**: 更丰富的分享格式和内容
- **社区功能**: 玩家讨论和策略分享
- **多人模式**: 多人同时游戏的模式

#### 数据分析 📊
- **游戏统计**: 详细的游戏数据统计
- **玩家行为分析**: 了解玩家偏好和难点
- **A/B测试**: 不同游戏机制的效果测试

### 长期目标 (3个月)

#### 平台扩展 📱
- **移动端应用**: 开发原生移动应用
- **桌面应用**: Electron桌面版本
- **浏览器扩展**: 简化版本的浏览器扩展

#### AI技术升级 🤖
- **多模型支持**: 支持多个AI模型
- **本地化AI**: 考虑本地AI模型部署
- **个性化AI**: 根据玩家特点定制AI行为

#### 内容生态 🌱
- **用户生成内容**: 允许玩家创建AI角色
- **模组系统**: 支持社区模组开发
- **跨媒体扩展**: 漫画、动画等周边内容

## 🤝 贡献指南

欢迎贡献代码、报告问题或提出建议！

### 贡献方式
- **报告Bug**: 提交详细的问题描述
- **功能建议**: 提出新的游戏功能想法
- **代码贡献**: 提交Pull Request
- **内容创作**: 创作新的AI角色或话题

### 开发规范
- 遵循现有代码风格
- 添加必要的注释
- 确保功能测试通过
- 更新相关文档

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 项目Issues: [GitHub Issues](链接)
- 邮箱: [联系邮箱]

---

## 📈 成功指标

### 用户指标
- **留存率**: 7日留存率达到40%
- **完成率**: 游戏完成率达到60%
- **分享率**: 结果分享率达到30%

### 技术指标
- **响应时间**: API响应时间<3秒
- **错误率**: 系统错误率<1%
- **加载时间**: 首屏加载时间<2秒

### 业务指标
- **用户增长**: 月活跃用户增长20%
- **收入**: 如果商业化，实现盈利
- **社区活跃度**: 社区参与度达到25%

## ⚠️ 风险评估

### 技术风险
- **API稳定性**: 外部API服务稳定性风险
- **扩展性**: 当前架构的扩展性限制
- **安全性**: 用户数据和内容安全

### 产品风险
- **用户粘性**: 游戏新鲜感过后的留存问题
- **内容审核**: AI生成内容的合规性
- **市场竞争**: 类似产品的竞争

### 缓解策略
1. **API备用方案**: 准备多个AI服务提供商
2. **架构升级**: 逐步升级到更现代的架构
3. **内容过滤**: 实现严格的内容审核机制
4. **差异化**: 强化游戏的独特性和深度

---

*《谁是人类》 - 让我们在AI时代重新思考人性的边界*

*这是一个既有深度又有趣味性的游戏项目，通过创新的方式让玩家思考AI与人类的关系，以及技术发展中的伦理问题。*